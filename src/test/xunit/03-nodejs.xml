<?xml version="1.0" ?><BEAKER_TEST><test_id>25815345</test_id><package>nodejs</package><pkgnotinstalled>nodejs</pkgnotinstalled><beakerlib_rpm>beakerlib-1.9-3.el7 </beakerlib_rpm><beakerlib_redhat_rpm>beakerlib-redhat-1-15.el7 </beakerlib_redhat_rpm><starttime>2014-11-07 08:25:53 EST</starttime><endtime>2014-11-07 08:26:10 EST</endtime><testname>/CoreOS/nodejs/Sanity/smoke</testname><release>Red Head Enterprise Limux X.Y (Moo)</release><hostname>some-p8-lp7-hostname.com</hostname><arch>zx_spectrum</arch><hw_cpu>0 x unknown</hw_cpu><hw_ram>17846 MB</hw_ram><hw_hdd>290.8 GB</hw_hdd><purpose>PURPOSE of /CoreOS/nodejs/Sanity/smoke
Description: Basic sanity smoke test
Author: Joe the Tester &lt;jttesterk@redhat.com&gt;

Test finds free port from a given port range and then starts a minimal node.js
http server. Server is queried for the expected response. After stopping the
server it's output is searched for messages confirming successful start as well
as successful response to a query.
</purpose><log><phase endtime="2014-11-07 08:25:54 EST" name="Setup" result="WARN" score="2" starttime="2014-11-07 08:25:53 EST" type="WARN"><pkgnotinstalled>nodejs</pkgnotinstalled><test message="Checking for the presence of nodejs rpm ">FAIL</test><pkgdetails sourcerpm="curl-7.29.0-19.ael7a.src.rpm">curl-7.29.0-19.ael7a.zx_spectrum </pkgdetails><test message="Checking for the presence of curl rpm ">PASS</test><message severity="LOG">Package versions:</message><message severity="LOG">  curl-7.29.0-19.ael7a.zx_spectrum</message><message severity="ERROR">node: command not found</message><test message="Binary 'node' should belong to: nodejs ">FAIL</test><message severity="INFO">Choosing server port...</message><message severity="INFO">&quot;8000&quot; chosen</message><test command="TmpDir=$(mktemp -d)" message="Creating tmp directory (Expected 0, got 0)">PASS</test><test command="cp server.js /tmp/tmp.NElB5dmfs6/." message="Copying server source file (Expected 0, got 0)">PASS</test><test command="pushd /tmp/tmp.NElB5dmfs6" message="Command 'pushd /tmp/tmp.NElB5dmfs6' (Expected 0, got 0)">PASS</test></phase><phase endtime="2014-11-07 08:26:08 EST" name="Test" result="FAIL" score="5" starttime="2014-11-07 08:25:56 EST" type="FAIL"><pkgnotinstalled>nodejs</pkgnotinstalled><pkgdetails sourcerpm="curl-7.29.0-19.ael7a.src.rpm">curl-7.29.0-19.ael7a.zx_spectrum </pkgdetails><test command="node server.js 8000 2&gt;&amp;1 &gt; server_out &amp;" message="Running server and logging output (Expected 0, got 0)">PASS</test><test command="sleep 10" message="Giving server &quot;10&quot; seconds to start (Expected 0, got 0)">PASS</test><test command="curl --max-time 10 http://127.0.0.1:8000 &gt; curl_out &amp;&amp; cat curl_out" message="Querying server (Expected 0, got 7)">FAIL</test><test command="grep 'Hello World' curl_out" message="Response should contain &quot;Hello World&quot; (Expected 0, got 1)">FAIL</test><test command="kill 30535" message="Stopping the server (Expected 0, got 1)">FAIL</test><test command="ps -e | grep 30535" message="Server should not be running (Expected 1, got 1)">PASS</test><test command="grep 'Request received.' server_out" message="Output should contain &quot;Request received.&quot; (Expected 0, got 1)">FAIL</test><test command="grep 'Server has started.' server_out" message="Output should contain &quot;Server has started.&quot; (Expected 0, got 1)">FAIL</test><test command="kill -SIGKILL 30535" message="Attempt killing possibly leftover server process (Expected 0,1, got 1)">PASS</test></phase><phase endtime="2014-11-07 08:26:10 EST" name="Cleanup" result="PASS" score="0" starttime="2014-11-07 08:26:09 EST" type="WARN"><pkgnotinstalled>nodejs</pkgnotinstalled><pkgdetails sourcerpm="curl-7.29.0-19.ael7a.src.rpm">curl-7.29.0-19.ael7a.zx_spectrum </pkgdetails><test command="popd" message="Command 'popd' (Expected 0, got 0)">PASS</test><test command="rm -r /tmp/tmp.NElB5dmfs6" message="Removing tmp directory (Expected 0, got 0)">PASS</test></phase></log></BEAKER_TEST>
